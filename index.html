<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Рулетка Шанса</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: radial-gradient(circle, #333, #111);
            color: white;
            font-family: "Multiround Pro";
        }
        .roulette-container {
            position: relative;
            width: 320px;
            height: 320px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            border: 5px solid #444;
        }
        .roulette {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .arrow {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid yellow;
            z-index: 10;
        }
        .controls {
            margin-top: 20px;
            text-align: center;
            position: relative;
        }
        input, button {
            padding: 12px;
            margin: 8px;
            border-radius: 12px;
            border: none;
            font-size: 18px;
        }
        button {
            background: #ff9800;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-family: "Multiround Pro";
        }
        button:hover {
            background: #e68900;
        }

        /* Стили для уведомления */
        .notification {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            font-size: 24px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .notification.show {
            opacity: 1;
        }

        /* Окно ввода шанса */
        .chance-input-container {
            position: absolute;
            top: 60px; /* Начальная позиция, немного выше кнопки */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            width: 250px;
            border-radius: 12px;
            display: flex; /* Изменено с none на flex для видимости */
            flex-direction: column;
            align-items: center;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            max-width: 600px; /* Максимальная ширина 600 пикселей */
        }

        /* Окно ввода ставки */
        .bet-input-container {
            position: absolute;
            max-width: 600px; /* Максимальная ширина 600 пикселей */
            top: 160px; /* Начальная позиция, немного выше кнопки */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 12px;
            display: flex; /* Изменено с none на flex для видимости */
            flex-direction: column;
            align-items: center;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .balance {
            font-size: 24px;
            margin-bottom: 20px;
        }

        /* Стили для окна пополнения баланса */
        .deposit-input-container {
            position: absolute;
            top: 260px; /* Позиция окна пополнения баланса */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 12px;
            display: none; /* Скрываем по умолчанию */
            flex-direction: column;
            align-items: center;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            max-width: 600px; /* Максимальная ширина 600 пикселей */
        }

        .deposit-input-container input[type="number"] {
            width: 200px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="balance">Баланс: <span id="balance">1000</span> UP</div>
    <div class="roulette-container">
        <div class="arrow"></div>
        <div class="roulette" id="roulette"></div>
    </div>
    <div class="controls">
        <button id="spinButton">Крутить</button>
        <div class="chance-input-container" id="chanceInputContainer">
            <input type="number" id="chance" placeholder="Введите шанс (0-100)" min="0" max="100" style="width: 215px;">
        </div>
        <div class="bet-input-container" id="betInputContainer">
            <input type="number" id="bet" placeholder="Введите ставку" min="0">
        </div>
        <!-- Кнопка и окно для пополнения баланса -->
        <button id="depositButton">Пополнить баланс</button>
        <div class="deposit-input-container" id="depositInputContainer">
            <input type="number" id="depositAmount" placeholder="Введите сумму (0-1000000)" min="0" max="5000" style="width: 215px;">
            <button id="confirmDepositButton">Подтвердить пополнение</button>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <!-- Звуки для победы и поражения -->
    <audio id="winSound" src="win.mp3"></audio>
    <audio id="loseSound" src="lose.mp3"></audio>
    <!-- Звук вращения рулетки -->
    <audio id="spinSound" src="spin.mp3" loop></audio>

    <script>
        const spinButton = document.getElementById('spinButton');
        const chanceInputContainer = document.getElementById('chanceInputContainer');
        const betInputContainer = document.getElementById('betInputContainer');
        const chanceInput = document.getElementById('chance');
        const betInput = document.getElementById('bet');
        const winSound = document.getElementById('winSound');
        const loseSound = document.getElementById('loseSound');
        const balanceSpan = document.getElementById('balance');
        const spinSound = document.getElementById('spinSound');
        const depositButton = document.getElementById('depositButton');
        const depositInputContainer = document.getElementById('depositInputContainer');
        const depositAmountInput = document.getElementById('depositAmount');
        const confirmDepositButton = document.getElementById('confirmDepositButton');
        const notification = document.getElementById('notification');
        
        let balance = 1000;
        let lastDepositTime = null;

        // Функция для отображения уведомлений
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Функция для обновления баланса на странице
        function updateBalance() {
            balanceSpan.textContent = balance.toFixed(2);
        }

        // Скрываем окно ввода при нажатии на кнопку "Крутить"
        spinButton.addEventListener('click', () => {
            let chance = parseInt(chanceInput.value);
            let bet = parseInt(betInput.value);

            if (isNaN(chance) || chance < 0 || chance > 100) {
                showNotification("Введите корректный шанс от 0 до 100");
                return;
            }

            if (isNaN(bet) || bet <= 0 || bet > balance) {
                showNotification("Введите корректную ставку. Она должна быть больше 0 и не превышать ваш баланс.");
                return;
            }

            balance -= bet;
            if (balance < 0) {
                balance += bet;
                updateBalance();
                showNotification("Недостаточно средств на балансе.");
                return;
            }

            updateBalance();
            spinRoulette(chance, bet);
        });

        function spinRoulette(chance, bet) {
            let winAngle = (chance / 100) * 360;
            let roulette = document.getElementById('roulette');
            let degrees = Math.floor(Math.random() * 3600) + 1800;
            roulette.style.background = `conic-gradient(green 0deg ${winAngle}deg, red ${winAngle}deg 360deg)`;
            roulette.style.transition = 'transform 6s ease-out';
            roulette.style.transform = `rotate(${degrees}deg)`;

            spinSound.currentTime = 0;
            spinSound.play();

            setTimeout(() => {
                let finalRotation = degrees % 360;
                let win = finalRotation >= (360 - winAngle);
                let resultText = win ? "Поздравляем, вы выиграли!" : "Вы проиграли. Попробуйте снова!";

                let payoutMultiplier = 100 / chance;
                let payout = win ? bet * payoutMultiplier : 0;

                balance += payout;
                updateBalance();

                showNotification(resultText + (win ? ` Вы выиграли ${payout.toFixed(2)} UP!` : ""));

                spinSound.pause();
                spinSound.currentTime = 0;

                if (win) {
                    winSound.play();
                } else {
                    loseSound.play();
                }

            }, 6000);
        }

        // Логика для кнопки "Пополнить баланс"
        depositButton.addEventListener('click', () => {
            depositInputContainer.style.display = 'flex'; // Показываем окно пополнения
            depositAmountInput.value = ''; // Очищаем поле ввода при открытии
        });

        // Подтверждение пополнения баланса
        confirmDepositButton.addEventListener('click', () => {
            let depositAmount = parseInt(depositAmountInput.value);

            if (isNaN(depositAmount) || depositAmount < 0 || depositAmount > 1000000) {
                showNotification("Введите корректную сумму пополнения от 0 до 1000000.");
                return;
            }

            if (lastDepositTime && (Date.now() - lastDepositTime) < 300000) { // 5 минут = 300000 мс
                showNotification("Вы можете пополнять баланс только раз в 5 минут.");
                return;
            }

            balance += depositAmount;
            updateBalance();
            lastDepositTime = Date.now(); // Обновляем время последнего пополнения
            depositInputContainer.style.display = 'none'; // Скрываем окно пополнения
            showNotification(`Баланс успешно пополнен на ${depositAmount} UP.`);
        });
    </script>
</body>
</html>
