<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Рулетка Шанса</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: radial-gradient(circle, #333, #111);
            color: white;
            font-family: "Multiround Pro";
        }
        .roulette-container {
            position: relative;
            width: 320px;
            height: 320px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            border: 5px solid #444;
        }
        .roulette {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .arrow {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid yellow;
            z-index: 10;
        }
        .controls {
            margin-top: 20px;
            text-align: center;
            position: relative;
        }
        input, button {
            padding: 12px;
            margin: 8px;
            border-radius: 12px;
            border: none;
            font-size: 18px;
            
        }
        button {
            background: #ff9800;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-family: "Multiround Pro";
        }
        button:hover {
            background: #e68900;
        }

        /* Стили для уведомления */
        .notification {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            font-size: 24px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            
        }

        .notification.show {
            opacity: 1;
        }

        /* Окно ввода шанса */
        .chance-input-container {
            position: absolute;
            top: 60px; /* Начальная позиция, немного выше кнопки */
            left: 50%;
            
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            width: 250px;
            border-radius: 12px;
            display: flex; /* Изменено с none на flex для видимости */
            flex-direction: column;
            align-items: center;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            max-width: 600px; /* Максимальная ширина 600 пикселей */
        }

         /* Окно ввода ставки */
        .bet-input-container {
            position: absolute;
            max-width: 600px; /* Максимальная ширина 600 пикселей */
            top: 160px; /* Начальная позиция, немного выше кнопки */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 12px;
            display: flex; /* Изменено с none на flex для видимости */
            flex-direction: column;
            align-items: center;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        }

        .balance {
            font-size: 24px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="balance">Баланс: <span id="balance">1000</span> UP</div>
    <div class="roulette-container">
        <div class="arrow"></div>
        <div class="roulette" id="roulette"></div>
    </div>
    <div class="controls">
        <button id="spinButton">Крутить</button>
        <div class="chance-input-container" id="chanceInputContainer">
            <input type="number" id="chance" placeholder="Введите шанс (0-100)" min="0" max="100" style="width: 215px;">
        </div>
        <div class="bet-input-container" id="betInputContainer">
            <input type="number" id="bet" placeholder="Введите ставку" min="0">
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <!-- Звуки для победы и поражения -->
    <audio id="winSound" src="win.mp3"></audio>
    <audio id="loseSound" src="lose.mp3"></audio>
    <!-- Звук вращения рулетки -->
    <audio id="spinSound" src="spin.mp3" loop></audio>

    <script>
        const spinButton = document.getElementById('spinButton');
        const chanceInputContainer = document.getElementById('chanceInputContainer');
        const betInputContainer = document.getElementById('betInputContainer');
        const chanceInput = document.getElementById('chance');
        const betInput = document.getElementById('bet');
        const winSound = document.getElementById('winSound');
        const loseSound = document.getElementById('loseSound');
        const balanceSpan = document.getElementById('balance');
        const spinSound = document.getElementById('spinSound'); // Добавляем звук вращения
        let balance = 1000;

        // Скрываем окно ввода при нажатии на кнопку
        spinButton.addEventListener('click', () => {
            let chance = parseInt(chanceInput.value);
            let bet = parseInt(betInput.value);

            if (isNaN(chance) || chance < 0 || chance > 100) {
                alert("Введите корректный шанс от 0 до 100");
                return;
            }

            if (isNaN(bet) || bet <= 0 || bet > balance) {
                alert("Введите корректную ставку. Она должна быть больше 0 и не превышать ваш баланс.");
                return;
            }

            balance -= bet; // Снимаем ставку
            
            // Проверяем, не уходит ли баланс в минус
            if (balance < 0) {
                balance += bet; // Возвращаем ставку
                updateBalance();
                alert("Недостаточно средств на балансе.");
                return;
            }

            updateBalance(); // Обновляем баланс сразу после снятия ставки
            spinRoulette(chance, bet);
        });

        function spinRoulette(chance, bet) {
            let winAngle = (chance / 100) * 360;
            let roulette = document.getElementById('roulette');
            let degrees = Math.floor(Math.random() * 3600) + 1800; // 5-10 полных оборотов
            roulette.style.background = `conic-gradient(green 0deg ${winAngle}deg, red ${winAngle}deg 360deg)`;
            roulette.style.transition = 'transform 6s ease-out';
            roulette.style.transform = `rotate(${degrees}deg)`;

            // Запускаем звук вращения
            spinSound.currentTime = 0; // Сбрасываем время воспроизведения
            spinSound.play();

            setTimeout(() => {
                let finalRotation = degrees % 360; // Угол, на котором остановилась рулетка
                let win = finalRotation >= (360 - winAngle);
                let resultText = win ? "Поздравляем, вы выиграли!" : "Вы проиграли. Попробуйте снова!";

                let payoutMultiplier = 100 / chance; // Чем меньше шанс, тем больше выплата
                let payout = win ? bet * payoutMultiplier : 0;

                balance += payout; // Начисляем выплату
                updateBalance(); // Обновляем баланс на странице

                showNotification(resultText + (win ? ` Вы выиграли ${payout.toFixed(2)} UP!` : ""));

                // Останавливаем звук вращения
                spinSound.pause();
                spinSound.currentTime = 0; // Сбрасываем время воспроизведения

                // Воспроизводим звук в зависимости от результата
                if (win) {
                    winSound.play();  // Звук победы
                } else {
                    loseSound.play();  // Звук поражения
                }

            }, 6000); // Duration of roulette spin animation
        }

        function updateBalance() {
            balanceSpan.textContent = balance.toFixed(2);
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000); // Уведомление исчезает через 2 секунды
        }
    </script>
</body>
</html>
